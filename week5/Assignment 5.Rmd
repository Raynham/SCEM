---
title: "Assignment 5"
author: "Ruinan Wang"
date: "27/10/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(purrr)
library(ggplot2)
```


### 2.Simulating data with the uniform distribution
```{r}
set.seed(0)

n<-1000

sample_X<-data.frame(U=runif(n))%>%
  mutate(X=case_when(
    (0<=U)&(U<0.25)~1,
    (0.25<=U)&(U<0.5)~5,
  (0.5<=U)&(U<=1)~0))%>%
  pull(X)
sample_X
```

#### why does this sample_X correspond to a sequence of i.i.d. copies X_1,....X__n of X where P(X=1) = a and P(X=5)=b and P(X=0) = 1-a-b with a=b=0.25?   
  runif function can generate the random numbers with uniform distribution in the range from 0 to 1. And set.seed() can generate the seed element of random number. case_when can get the number corresponds to the probability.
  

#### Now create a function called sample_X_015() which takes as inputs a,b and n and outputs a sample X_1,....X_n of indenpendent copies of X where P (X=1)=a and P (X=5)=b and P (X=0)=1-a-b.

```{r}
sample_x_015<-function (a,b,n){
  
  if (a>1||a<0||b>1||b<0||a+b>1||!is.integer(n))
    return("there is something wrong")
  else{
    set.seed(0)
    sample_015<-data.frame(U = runif(n))%>%
      mutate(X=case_when(
        (0<=U)&(U<a)~1,
        (a<=U)&(U<a+b)~5,
        (a+b<=U)&(U<1)~0))%>%
      pull(X)
    return(sample_015)
  }
}

sample_result <- sample_x_015(0.5,0.01,1000L)
mean(sample_result)
expe <- 0.5*1+0.01*1
expe
```

when the number of sample becomes more and more, the mean average of sample is more close to the expectation of the sample



```{r}
sample_list <- data.frame(B_prob =seq(0,0.9,by=0.01))%>%
  mutate(samples_average = map(B_prob,~mean(sample_x_015(0.1,.x,100L))))
ggplot(data=sample_list, aes(x=B_prob, y=samples_average))+geom_line()

```